@model KhachHangWeb.Models.CheckoutViewModel
@{
    ViewData["Title"] = "Thanh toan";
}
<h3>Thanh toan</h3>

@if (!Model.Items.Any())
{
    <p>Gio hang trong. <a href="/shop">Mua tiep</a></p>
}
else
{
<div class="row g-3">
  <div class="col-md-7">
    <table class="table">
      <thead>
        <tr>
          <th>Ten san pham</th>
          <th>Don gia</th>
          <th>So luong</th>
          <th>Thanh tien</th>
        </tr>
      </thead>
      <tbody>
      @foreach (var i in Model.Items)
      {
        <tr>
          <td>@i.Name</td>
          <td>@String.Format("{0:N0} d", i.UnitPrice)</td>
          <td>@i.Quantity</td>
          <td>@String.Format("{0:N0} d", i.UnitPrice * i.Quantity)</td>
        </tr>
      }
      </tbody>
    </table>
  </div>

  <div class="col-md-5">
    <div class="card">
      <div class="card-body">
        @Html.ValidationSummary()
        <p class="fw-bold">Tong tien: @String.Format("{0:N0} d", Model.Total)</p>
        <p class="mb-1">Hang thanh vien: <strong>@Model.MemberTier</strong></p>
        <p class="mb-1">Giam theo hang: @String.Format("{0:N0} d", Model.MemberDiscountAmount)</p>

        <form method="post" action="/checkout/placeorder">
          <input type="hidden" name="branchId" value="@Model.SelectedBranch" />
          <input type="hidden" name="recalc" value="false" />

          <div class="mb-3">
            <label class="form-label">Chi nhanh / thu cung</label>
            <div class="text-muted small">
              He thong tu dong chon chi nhanh phu hop va thu cung mac dinh.
            </div>
          </div>

          <div class="mb-3">
            <label class="form-label">Diem tich luy</label>
            <div class="text-muted small">Hien co: @Model.PointsAvailable diem (1 diem = 1.000 d khi su dung)</div>
            <div class="form-check mt-2">
              <input class="form-check-input" type="checkbox" name="usePoints" value="true" @(Model.UsePoints ? "checked" : "") onchange="this.form.recalc.value='true'; this.form.submit();" />
              <label class="form-check-label">Dung diem tich luy</label>
            </div>
            <div class="text-muted small mt-1">Da giam: @String.Format("{0:N0} d", Model.PointsDiscountAmount)</div>
          </div>

          <div class="mb-3">
            <label class="form-label">Hinh thuc thanh toan</label>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="paymentMethod" value="The" @(Model.PaymentMethod == "The" ? "checked" : "") />
              <label class="form-check-label">The</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="paymentMethod" value="Tien mat" @(Model.PaymentMethod == "Tien mat" ? "checked" : "") />
              <label class="form-check-label">Tien mat</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="paymentMethod" value="Chuyen khoan" @(Model.PaymentMethod == "Chuyen khoan" ? "checked" : "") />
              <label class="form-check-label">Chuyen khoan</label>
            </div>
          </div>

          <div class="mb-3">
            <label class="form-label">So tien phai tra</label>
            <div class="fw-bold">@String.Format("{0:N0} d", Model.Payable)</div>
          </div>

          <div class="form-check mb-3">
            <input class="form-check-input" type="checkbox" name="payNow" value="true" checked />
            <label class="form-check-label">Thanh toan ngay</label>
          </div>

          <div class="d-flex gap-2">
            <a class="btn btn-outline-secondary" href="/cart">Quay lai</a>
            <button class="btn btn-success">Xac nhan</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
}
