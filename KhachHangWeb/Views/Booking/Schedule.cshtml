@model KhachHangWeb.Models.DoctorScheduleViewModel
@{
    ViewData["Title"] = "Lịch bác sĩ";
}
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Sora:wght@300;500;700&display=swap">
<style>
  .schedule-shell { font-family: "Sora", sans-serif; background: linear-gradient(120deg, #f6fffb 0%, #e8f4ff 55%, #ffffff 100%); padding: 24px; border-radius: 16px; }
  .schedule-title { font-size: 26px; font-weight: 700; color: #104b5b; margin-bottom: 10px; }
  .schedule-card { background: #fff; border-radius: 14px; padding: 18px; box-shadow: 0 10px 24px rgba(16, 75, 91, 0.08); }
  .schedule-table th { background: #e9f7f5; }
</style>

<div class="schedule-shell">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div>
      <div class="schedule-title">Tra cứu lịch bác sĩ</div>
      <div class="text-muted">Chọn bác sĩ và ngày để xem lịch hẹn.</div>
    </div>
    <a class="btn btn-outline-primary" href="/booking">Đặt lịch</a>
  </div>

  <form method="get" class="row g-2 mb-3">
    <div class="col-md-3">
      <select class="form-select" name="branchId" id="branchSelect">
        @foreach (var b in Model.Branches)
        {
          <option value="@b.Id" selected="@(Model.BranchId == b.Id ? "selected" : null)">@b.Name</option>
        }
      </select>
    </div>
    <div class="col-md-3">
      <select class="form-select" name="doctorId">
        @foreach (var d in Model.Doctors)
        {
          <option value="@d.Id" selected="@(Model.DoctorId == d.Id ? "selected" : null)">@d.Name</option>
        }
      </select>
    </div>
    <div class="col-md-3">
      <input class="form-control" type="date" name="date" value="@Model.Date.ToString("yyyy-MM-dd")" />
    </div>
    <div class="col-md-2">
      <button class="btn btn-primary w-100" type="submit">Xem lịch</button>
    </div>
  </form>

  <div class="schedule-card">
    @if (!Model.Items.Any())
    {
      <p>Chưa có lịch hẹn.</p>
    }
    else
    {
      <table class="table schedule-table">
        <thead>
          <tr>
            <th>Giờ</th>
            <th>Thú cưng</th>
            <th>Dịch vụ</th>
            <th>Chi nhánh</th>
          </tr>
        </thead>
        <tbody>
        @foreach (var item in Model.Items)
        {
          <tr>
            <td>@item.Time.ToString("HH:mm")</td>
            <td>@item.PetName (@item.PetId)</td>
            <td>@item.ServiceName</td>
            <td>@item.BranchName</td>
          </tr>
        }
        </tbody>
      </table>
    }
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const branchSelect = document.getElementById("branchSelect");
    if (branchSelect) {
      branchSelect.addEventListener("change", () => {
        const params = new URLSearchParams();
        params.set("branchId", branchSelect.value);
        window.location.assign("/booking/schedule?" + params.toString());
      });
    }
  });
</script>
